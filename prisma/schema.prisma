// Prisma schema for Wedding Gallery D1 Database
// This schema matches the existing D1 database structure

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

model Media {
  // Primary key
  key String @id

  // Basic file information
  filename   String
  type       String  // 'image' or 'video'
  size       Int?
  uploadedAt DateTime? @map("uploaded_at")

  // EXIF metadata
  dateTaken    DateTime? @map("date_taken")
  cameraMake   String? @map("camera_make")
  cameraModel  String? @map("camera_model")
  lens         String?
  focalLength  Float?  @map("focal_length")
  aperture     Float?
  shutterSpeed Float?  @map("shutter_speed")
  iso          Int?

  // GPS coordinates
  latitude  Float?
  longitude Float?
  altitude  Float?

  // Video metadata
  duration Float?
  codec    String?

  // Dimensions
  width  Int?
  height Int?

  // HLS streaming qualities (JSON array)
  hlsQualities String? @map("hls_qualities")

  // Thumbnail paths
  thumbnailSmall  String? @map("thumbnail_small")
  thumbnailMedium String? @map("thumbnail_medium")
  thumbnailLarge  String? @map("thumbnail_large")

  // Full EXIF metadata (JSON blob)
  metadata String?

  // Public access flag
  isPublic Boolean @default(false) @map("is_public")

  // Timestamps (Note: Application code explicitly sets these)
  processedAt DateTime? @map("processed_at")
  createdAt   DateTime  @map("created_at")
  updatedAt   DateTime  @map("updated_at")

  @@map("media")
}

model PendingThumbnails {
  key       String @id
  // Note: Application code explicitly sets createdAt
  createdAt DateTime @map("created_at")

  @@map("pending_thumbnails")
}
